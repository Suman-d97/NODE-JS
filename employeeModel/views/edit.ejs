<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Edit Employee</title>

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />

    <style>
      body {
        background: #f4f6f9;
      }

      .card {
        border-radius: 10px;
      }

      .profile-img {
        width: 120px;
        height: 120px;
        object-fit: cover;
        border-radius: 50%;
        border: 3px solid #007bff;
        margin: 15px auto;
        display: block;
      }
    </style>
  </head>

  <body>
    <div class="container py-5">
      <div class="row justify-content-center">
        <div class="col-md-6">
          <form
            action="/employee/edit/<%= employee._id %>"
            method="POST"
            enctype="multipart/form-data"
          >
            <div class="card shadow">
    
              <div class="card-header bg-primary text-white text-center">
                <i class="fa fa-user-edit"></i> Edit Employee
              </div>

              <div class="card-body text-center">
                <% if (employee.image) { %>

                <img
                  src="/<%= employee.image %>"
                  class="profile-img"
                  alt="Profile Image"
                />

                <% } else { %>

                <img
                  src="https://cdn-icons-png.freepik.com/256/11136/11136505.png"
                  class="profile-img"
                  alt="Default Image"
                />

                <% } %>

                <h5><%= employee.name %></h5>

                <p class="text-muted">
                  Employee ID: <%= employee.employee_id %>
                </p>
              </div>

              <ul class="list-group list-group-flush">
  
                <li class="list-group-item">
                  <label>
                    <i class="fa fa-user text-primary"></i>
                    Employee Name
                  </label>

                  <input
                    type="text"
                    class="form-control"
                    name="name"
                    required
                    value="<%= employee.name %>"
                  />
                </li>

                <li class="list-group-item">
                  <label>
                    <i class="fa fa-id-badge text-primary"></i>
                    Employee ID
                  </label>

                  <input
                    type="text"
                    class="form-control"
                    name="employee_id"
                    value="<%= employee.employee_id %>"
                    readonly
                  />
                </li>
                <li class="list-group-item">
                  <label>
                    <i class="fa fa-envelope text-primary"></i>
                    Email
                  </label>

                  <input
                    type="email"
                    class="form-control"
                    name="contact[email]"
                    value="<%= employee.contact.email %>"
                  />
                </li>

                <li class="list-group-item">
                  <label>
                    <i class="fa fa-phone text-primary"></i>
                    Phone
                  </label>

                  <input
                    type="number"
                    class="form-control"
                    name="contact[phone]"
                    value="<%= employee.contact.phone %>"
                  />
                </li>

                <li class="list-group-item">
                  <label>
                    <i class="fa fa-building text-primary"></i>
                    Department
                  </label>

                  <select
                    class="form-control"
                    name="department[department_name]"
                    multiple
                    required
                  >
                    <%
                    const depts = [
                      "Information Technology",
                      "Research and Development",
                      "Marketing and Sales",
                      "Human Resources",
                      "Finance and Accounting",
                      "Sales & Marketing",
                      "Fast-Moving Consumer Goods",
                      "Media and Entertainment",
                      "Construction and Real Estate"
                    ];

                    const selectedDepts =
                      employee.department.department_name || [];
                    %>

                    <% depts.forEach(function (dept) { %>

                    <option
                      value="<%= dept %>"
                      <%= selectedDepts.includes(dept) ? "selected" : "" %>
                    >
                      <%= dept %>
                    </option>

                    <% }); %>
                  </select>
                </li>

                <li class="list-group-item">
                  <label>
                    <i class="fa fa-location-dot text-primary"></i>
                    Address
                  </label>

                  <input
                    type="text"
                    class="form-control"
                    name="contact[address]"
                    value="<%= employee.contact.address %>"
                  />
                </li>

                <li class="list-group-item">
                  <label>
                    <i class="fa fa-city text-primary"></i>
                    City
                  </label>

                  <input
                    type="text"
                    class="form-control"
                    name="contact[city]"
                    value="<%= employee.contact.city %>"
                  />
                </li>

                <li class="list-group-item">
                  <label>
                    <i class="fa fa-map text-primary"></i>
                    Full Address
                  </label>

                  <textarea
                    class="form-control"
                    name="contact[full_address]"
                    rows="2"
                  ><%= employee.contact.full_address %></textarea>
                </li>

                <li class="list-group-item">
                  <label>
                    <i class="fa fa-image text-primary"></i>
                    Change Profile Image
                  </label>

                  <input
                    type="file"
                    class="form-control-file"
                    name="image"
                  />
                </li>
              </ul>

              <div class="card-body text-center">
                <a href="/employee/list" class="btn btn-secondary">
                  <i class="fa fa-arrow-left"></i>
                  Cancel
                </a>

                <button type="submit" class="btn btn-success">
                  <i class="fa fa-save"></i>
                  Update
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </body>
</html>